<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean name="Simulation" class="com.github.themetalone.parking.core.simulations.MultipleCasesParallelSimulation">
        <constructor-arg index="0" value="500000"/>
        <constructor-arg index="1">
            <list>
                <ref bean="BlockCountStreet"/>
                <ref bean="FixedDistanceStreet"/>
                <ref bean="CarCountStreet"/>
            </list>
        </constructor-arg>
        <property name="simulationDataCollectors">
            <list>
                <ref bean="BlockCountDataCollector"/>
                <ref bean="FixedDistanceDataCollector"/>
                <ref bean="CarCountDataCollector"/>
            </list>
        </property>
    </bean>

    <bean name="MemorySize" class="java.lang.Integer">
        <constructor-arg index="0" type="int" value="10"/>
    </bean>
    <bean name="MutationRate" class="java.lang.Double">
        <constructor-arg index="0" type="double" value="0.1"/>
    </bean>
    <bean name="NextCarDistribution" class="org.apache.commons.math3.distribution.UniformIntegerDistribution">
        <constructor-arg index="0" value="0"/>
        <constructor-arg index="1" value="80"/> <!--waits at most 80 ticks, mean of 2 Cars per minute -->
    </bean>
    <bean name="LongestParkingTime" class="java.lang.Integer">
        <constructor-arg index="0" value="4800" type="int"/> <!-- 1h -->
    </bean>
    <bean name="NumberOfParkingSpots" class="java.lang.Integer">
        <constructor-arg type="int" value="150"/>
    </bean>

    <bean name="BlockCountStreet" class="com.github.themetalone.parking.hutchinson.street.HutchinsonStreetImpl">
        <constructor-arg index="0" value="0"/>
        <constructor-arg index="1" ref="NumberOfParkingSpots"/>
        <constructor-arg index="2" ref="BlockCountCarProvider"/>
        <constructor-arg index="3" ref="BlockCountParkingSpotProvider"/>
        <constructor-arg index="4" ref="NextCarDistribution"/>
        <property name="observers">
            <list>
                <ref bean="BlockCountHeuristic"/>
            </list>
        </property>
    </bean>
    <bean name="BlockCountDataCollector" class="com.github.themetalone.parking.core.data.H2SimulationDataCollectorImpl">
        <constructor-arg value="./BlockCountData"/>
    </bean>
    <bean name="BlockCountHeuristicProvider"
          class="com.github.themetalone.parking.core.car.heuristic.providers.SingleMutantHeuristicProvider">
        <property name="population" ref="PopulationHeuristic"/>
        <property name="mutant" ref="BlockCountHeuristic"/>
        <property name="providedUntil" value="50"/>
    </bean>
    <bean name="BlockCountHeuristic"
          class="com.github.themetalone.parking.core.car.heuristic.selfLearning.heuristic.SelfLearningIntegerHeuristic">
        <constructor-arg index="0">
            <bean class="com.github.themetalone.parking.core.car.heuristic.BlockCountHeuristic">
                <constructor-arg value="10"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="1">
            <bean class="com.github.themetalone.parking.core.car.heuristic.selfLearning.memories.IntegerMemory">
                <constructor-arg ref="MemorySize"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="2" ref="MutationRate"/>
        <constructor-arg index="3" ref="ZeroToOneUniformRealDistribution"/>
        <constructor-arg index="4">
            <bean class="org.apache.commons.math3.distribution.UniformIntegerDistribution">
                <constructor-arg index="0" value="1"/>
                <constructor-arg index="1" value="100"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="5" ref="BlockCountDataCollector"/>
    </bean>
    <bean name="BlockCountParkingSpotProvider" class="com.github.themetalone.parking.core.slot.ParkingSlotProviderImpl">
        <property name="simulationDataCollector" ref="BlockCountDataCollector"/>
    </bean>
    <bean name="BlockCountCarProvider"
          class="com.github.themetalone.parking.hutchinson.car.FiniteHutchinsonCarProviderImpl">
        <constructor-arg value="150"/>
        <property name="heuristicProvider" ref="BlockCountHeuristicProvider"/>
        <property name="simulationDataCollector" ref="BlockCountDataCollector"/>
        <property name="longestParkingTime" ref="LongestParkingTime"/>
        <property name="realDistribution" ref="CarWaitingDistribution"/>
        <property name="parkingSlotProvider" ref="BlockCountParkingSpotProvider"/>
    </bean>

    <bean name="FixedDistanceStreet" class="com.github.themetalone.parking.hutchinson.street.HutchinsonStreetImpl">
        <constructor-arg index="0" value="1"/>
        <constructor-arg index="1" ref="NumberOfParkingSpots"/>
        <constructor-arg index="2" ref="FixedDistanceCarProvider"/>
        <constructor-arg index="3" ref="FixedDistanceParkingSpotProvider"/>
        <constructor-arg index="4" ref="NextCarDistribution"/>
        <property name="observers">
            <list>
                <ref bean="FixedDistanceHeuristic"/>
            </list>
        </property>
    </bean>
    <bean name="FixedDistanceDataCollector"
          class="com.github.themetalone.parking.core.data.H2SimulationDataCollectorImpl">
        <constructor-arg value="./FixedDistanceData"/>
    </bean>
    <bean name="FixedDistanceHeuristicProvider"
          class="com.github.themetalone.parking.core.car.heuristic.providers.SingleMutantHeuristicProvider">
        <property name="population" ref="PopulationHeuristic"/>
        <property name="mutant" ref="FixedDistanceHeuristic"/>
        <property name="providedUntil" value="50"/>
    </bean>
    <bean name="FixedDistanceHeuristic"
          class="com.github.themetalone.parking.core.car.heuristic.selfLearning.heuristic.SelfLearningIntegerHeuristic">
        <constructor-arg index="0">
            <bean class="com.github.themetalone.parking.core.car.heuristic.ChooseBetterThanNHeuristic">
                <constructor-arg value="10"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="1">
            <bean class="com.github.themetalone.parking.core.car.heuristic.selfLearning.memories.IntegerMemory">
                <constructor-arg ref="MemorySize"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="2" ref="MutationRate"/>
        <constructor-arg index="3" ref="ZeroToOneUniformRealDistribution"/>
        <constructor-arg index="4">
            <bean class="org.apache.commons.math3.distribution.UniformIntegerDistribution">
                <constructor-arg index="0" value="1"/>
                <constructor-arg index="1" value="150"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="5" ref="FixedDistanceDataCollector"/>
    </bean>
    <bean name="FixedDistanceParkingSpotProvider"
          class="com.github.themetalone.parking.core.slot.ParkingSlotProviderImpl">
        <property name="simulationDataCollector" ref="FixedDistanceDataCollector"/>
    </bean>
    <bean name="FixedDistanceCarProvider"
          class="com.github.themetalone.parking.hutchinson.car.FiniteHutchinsonCarProviderImpl">
        <constructor-arg value="150"/>
        <property name="heuristicProvider" ref="FixedDistanceHeuristicProvider"/>
        <property name="simulationDataCollector" ref="FixedDistanceDataCollector"/>
        <property name="longestParkingTime" ref="LongestParkingTime"/>
        <property name="realDistribution" ref="CarWaitingDistribution"/>
        <property name="parkingSlotProvider" ref="FixedDistanceParkingSpotProvider"/>
    </bean>

    <bean name="CarCountStreet" class="com.github.themetalone.parking.hutchinson.street.HutchinsonStreetImpl">
        <constructor-arg index="0" value="1"/>
        <constructor-arg index="1" ref="NumberOfParkingSpots"/>
        <constructor-arg index="2" ref="CarCountCarProvider"/>
        <constructor-arg index="3" ref="CarCountParkingSpotProvider"/>
        <constructor-arg index="4" ref="NextCarDistribution"/>
        <property name="observers">
            <list>
                <ref bean="CarCountHeuristic"/>
            </list>
        </property>
    </bean>
    <bean name="CarCountDataCollector" class="com.github.themetalone.parking.core.data.H2SimulationDataCollectorImpl">
        <constructor-arg value="./CarCountData"/>
    </bean>
    <bean name="CarCountHeuristicProvider"
          class="com.github.themetalone.parking.core.car.heuristic.providers.SingleMutantHeuristicProvider">
        <property name="population" ref="PopulationHeuristic"/>
        <property name="mutant" ref="CarCountHeuristic"/>
        <property name="providedUntil" value="50"/>
    </bean>
    <bean name="CarCountHeuristic"
          class="com.github.themetalone.parking.core.car.heuristic.selfLearning.heuristic.SelfLearningIntegerHeuristic">
        <constructor-arg index="0">
            <bean class="com.github.themetalone.parking.core.car.heuristic.CarCountHeuristic">
                <constructor-arg value="10"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="1">
            <bean class="com.github.themetalone.parking.core.car.heuristic.selfLearning.memories.IntegerMemory">
                <constructor-arg ref="MemorySize"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="2" ref="MutationRate"/>
        <constructor-arg index="3" ref="ZeroToOneUniformRealDistribution"/>
        <constructor-arg index="4">
            <bean class="org.apache.commons.math3.distribution.UniformIntegerDistribution">
                <constructor-arg index="0" value="1"/>
                <constructor-arg index="1" value="100"/>
            </bean>
        </constructor-arg>
        <constructor-arg index="5" ref="FixedDistanceDataCollector"/>
    </bean>
    <bean name="CarCountParkingSpotProvider" class="com.github.themetalone.parking.core.slot.ParkingSlotProviderImpl">
        <property name="simulationDataCollector" ref="CarCountDataCollector"/>
    </bean>
    <bean name="CarCountCarProvider"
          class="com.github.themetalone.parking.hutchinson.car.FiniteHutchinsonCarProviderImpl">
        <constructor-arg value="150"/>
        <property name="heuristicProvider" ref="CarCountHeuristicProvider"/>
        <property name="simulationDataCollector" ref="CarCountDataCollector"/>
        <property name="longestParkingTime" ref="LongestParkingTime"/>
        <property name="realDistribution" ref="CarWaitingDistribution"/>
        <property name="parkingSlotProvider" ref="CarCountParkingSpotProvider"/>
    </bean>

    <bean name="PopulationHeuristic"
          class="com.github.themetalone.parking.core.car.heuristic.JustParkSomewhereHeuristic"/>
    <bean name="ZeroToOneUniformRealDistribution" class="org.apache.commons.math3.distribution.UniformRealDistribution">
        <constructor-arg index="0" value="0" type="double"/>
        <constructor-arg index="1" value="1" type="double"/>
    </bean>
    <bean name="CarWaitingDistribution" class="org.apache.commons.math3.distribution.GammaDistribution">
        <constructor-arg name="scale" value="2"/>
        <constructor-arg name="shape" value="1200"/> <!-- equivalent to mode = 15 min -->
    </bean>
</beans>